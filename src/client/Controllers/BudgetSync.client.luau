--!strict

--[[
	BrainCoinSync (LocalScript)
	Tower Defense temps r√©el ‚Äî Synchronise les BrainCoin serveur avec le GameStore client.
	√âcoute le RemoteEvent BudgetUpdate pour mettre √† jour BrainCoin et BaseHP.
]]

-- Services
local ReplicatedStorage: ReplicatedStorage = game:GetService("ReplicatedStorage")

-- Modules
local sharedFolder: Instance = ReplicatedStorage:WaitForChild("Shared")
local GameStore = require(script.Parent.Parent:WaitForChild("State"):WaitForChild("GameStore"))

-- RemoteEvents
local eventsFolder: Instance = sharedFolder:WaitForChild("Events")
local budgetUpdateEvent: RemoteEvent = eventsFolder:WaitForChild("BudgetUpdate") :: RemoteEvent

-------------------------------------------------
-- √âcouter les mises √† jour de BrainCoin du serveur
-------------------------------------------------
budgetUpdateEvent.OnClientEvent:Connect(function(brainCoin: unknown, baseHP: unknown): ()
	local bc: number = if typeof(brainCoin) == "number" then brainCoin else 0
	local hp: number = if typeof(baseHP) == "number" then baseHP else 0

	GameStore.SetBrainCoin(bc, hp)
	print(`[BrainCoinSync] üß† BrainCoin: {bc} | üè† Base HP: {hp}`)
end)

print("[BrainCoinSync] ‚úÖ Initialis√© ‚Äî √âcoute BudgetUpdate")
